<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Ranking Audiovisual Pro</title>
    <style>
        /* ... (Mantenha todo o seu CSS igual aqui) ... */
        :root { --primary: #ffd700; --bg-dark: #0a0a0a; --card-bg: #1a1a1a; --text-gray: #aaa; --transition: all 0.3s ease; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background-color: var(--bg-dark); color: #eee; padding: 20px; margin: 0; }
        h1 { text-align: center; color: var(--primary); margin-bottom: 30px; }
        .controles { max-width: 800px; margin: 0 auto 30px; text-align: center; }
        #busca { width: 100%; max-width: 400px; padding: 12px 20px; border-radius: 25px; border: 1px solid #333; background: #1a1a1a; color: white; outline: none; margin-bottom: 15px; transition: var(--transition); }
        #busca:focus { border-color: var(--primary); }
        .botoes button { background: #222; color: #eee; border: 1px solid #444; padding: 8px 16px; margin: 4px; border-radius: 6px; cursor: pointer; transition: var(--transition); }
        .botoes button:hover { background: #333; border-color: var(--primary); }
        .ranking { max-width: 850px; margin: auto; }
        .item { display: flex; align-items: stretch; gap: 20px; background: var(--card-bg); margin-bottom: 20px; padding: 15px; border-radius: 12px; border: 1px solid #2a2a2a; animation: surgimento 0.5s ease-out; transition: var(--transition); }
        .item:hover { transform: translateY(-3px); border-color: #444; box-shadow: 0 10px 20px rgba(0,0,0,0.4); }
        .posicao { display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; color: var(--primary); min-width: 50px; border-right: 1px solid #333; padding-right: 10px; }
        .img-container { width: 120px; display: flex; align-items: center; }
        .item img { width: 120px; height: 100%; min-height: 120px; object-fit: cover; border-radius: 8px; background: #222; }
        .conteudo { flex: 1; display: flex; flex-direction: column; justify-content: center; gap: 5px; }
        .tag-tipo { font-size: 10px; text-transform: uppercase; color: var(--primary); letter-spacing: 1px; margin-bottom: 4px; opacity: 0.8; }
        .titulo { font-size: 1.2rem; font-weight: bold; color: #fff; line-height: 1.2; }
        .descricao { font-size: 0.95rem; color: var(--text-gray); margin-top: 5px; }
        .estrelas { color: var(--primary); font-size: 18px; margin-top: 10px; letter-spacing: 2px; display: flex; align-items: center; }
        @keyframes surgimento { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        @media (max-width: 480px) { .item { flex-direction: column; } .posicao { border-right: none; border-bottom: 1px solid #333; padding: 0 0 10px 0; } .img-container { width: 100%; justify-content: center; } .item img { width: 100%; max-width: 200px; } }
    </style>
</head>
<body>

<h1>üèÜ Ranking de Experi√™ncias</h1>

<div class="controles">
    <input type="text" id="busca" placeholder="Pesquisar..." oninput="filtrar()">
    <div class="botoes">
        <button onclick="mostrarRanking('geral')">üåå Geral</button>
        <button onclick="mostrarRanking('series')">üì∫ S√©ries</button>
        <button onclick="mostrarRanking('filmes')">üé¨ Filmes</button>
        <button onclick="mostrarRanking('jogos')">üéÆ Jogos</button>
        <button onclick="inverterOrdem()">üîÅ Inverter</button>
    </div>
</div>

<div id="ranking-container" class="ranking"></div>

<script src="dados.js"></script>

<script>
    // Note que a "const obras" sumiu daqui! Ela agora vem do arquivo acima.

    let filtroAtual = "geral";
    let ordemNormal = false;
    let termoBusca = "";

    function escapeHTML(str) {
        const p = document.createElement('p');
        p.textContent = str;
        return p.innerHTML;
    }

    function gerarEstrelas(nota) {
        const nota5 = nota / 2;
        let estrelasHTML = '';
        for (let i = 1; i <= 5; i++) {
            if (nota5 >= i) {
                estrelasHTML += '‚òÖ'; 
            } else if (nota5 >= i - 0.5) {
                estrelasHTML += '<span style="position:relative; display:inline-block;">' +
                               '<span style="color:#444">‚òÜ</span>' +
                               '<span style="position:absolute; left:0; top:0; width:45%; overflow:hidden;">‚òÖ</span>' +
                               '</span>';
            } else {
                estrelasHTML += '<span style="color:#444">‚òÜ</span>'; 
            }
        }
        return estrelasHTML;
    }

    function renderizarRanking() {
        const container = document.getElementById("ranking-container");
        // A vari√°vel "obras" √© acessada aqui normalmente
        let lista = filtroAtual === "geral" ? [...obras] : obras.filter(o => o.tipo === filtroAtual);
        
        if (termoBusca) {
            lista = lista.filter(o => o.titulo.toLowerCase().includes(termoBusca.toLowerCase()));
        }
        
        lista.sort((a, b) => b.nota - a.nota);
        const totalItens = lista.length;
        if (!ordemNormal) lista.reverse();

        container.innerHTML = lista.map((obra, index) => {
            const posicaoReal = ordemNormal ? (index + 1) : (totalItens - index);
            return `
                <div class="item">
                    <div class="posicao">#${posicaoReal}</div>
                    <div class="img-container">
                        <img src="${obra.imagem}" alt="Poster" onerror="this.src='https://via.placeholder.com/120x150?text=Erro'">
                    </div>
                    <div class="conteudo">
                        <div class="titulo">${escapeHTML(obra.titulo)}</div>
                        <div class="descricao">${escapeHTML(obra.descricao)}</div>
                        <div class="estrelas">${gerarEstrelas(obra.nota)}</div>
                    </div>
                </div>
            `;
        }).join('') || "<p style='text-align:center; color:#666'>Nenhum resultado encontrado.</p>";
    }

    function mostrarRanking(tipo) { filtroAtual = tipo; renderizarRanking(); }
    function inverterOrdem() { ordemNormal = !ordemNormal; renderizarRanking(); }
    function filtrar() { termoBusca = document.getElementById("busca").value; renderizarRanking(); }

    renderizarRanking();
</script>
</body>
</html>